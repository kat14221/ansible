---
# Playbook: Configuraci√≥n de Seguridad Local B√°sica
# Descripci√≥n: Configura hardening, SSH, firewall y auditor√≠a

- name: Configurar Seguridad Local B√°sica
  hosts: debian_router
  become: yes
  gather_facts: yes
  
  tasks:
    - name: Aplicar rol de hardening del sistema
      include_role:
        name: hardening
      tags: hardening
    
    - name: Aplicar rol de hardening SSH
      include_role:
        name: ssh-hardening
      tags: ssh
    
    - name: Aplicar rol de pol√≠ticas de firewall
      include_role:
        name: firewall-policy
      tags: firewall

- name: Resumen de Seguridad Configurada
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Mostrar resumen completo
      debug:
        msg:
          - "=========================================="
          - "‚úÖ SEGURIDAD LOCAL B√ÅSICA CONFIGURADA"
          - "=========================================="
          - ""
          - "üîí HARDENING DEL SISTEMA:"
          - "   ‚Ä¢ Kernel hardening (sysctl)"
          - "   ‚Ä¢ Usuario operator con permisos limitados"
          - "   ‚Ä¢ L√≠mites de recursos configurados"
          - "   ‚Ä¢ Servicios innecesarios deshabilitados"
          - "   ‚Ä¢ Umask seguro (027)"
          - "   ‚Ä¢ Auditd configurado"
          - ""
          - "üîê HARDENING SSH:"
          - "   ‚Ä¢ PermitRootLogin: no"
          - "   ‚Ä¢ PasswordAuthentication: no"
          - "   ‚Ä¢ PubkeyAuthentication: yes"
          - "   ‚Ä¢ MaxAuthTries: 3"
          - "   ‚Ä¢ Algoritmos seguros"
          - "   ‚Ä¢ Fail2ban activo"
          - ""
          - "üõ°Ô∏è FIREWALL ASIM√âTRICO:"
          - "   ‚Ä¢ Zona internal: 2025:db8:101::/64"
          - "   ‚Ä¢ Zona external: 2025:db8:100::/64"
          - "   ‚Ä¢ Reglas asim√©tricas configuradas"
          - "   ‚Ä¢ 2025:db8:100::/64 ‚Üí 2025:db8:101::/64 ‚úÖ"
          - "   ‚Ä¢ 2025:db8:101::/64 ‚Üí 2025:db8:100::/64 ‚ùå"
          - ""
          - "üìä AUDITOR√çA:"
          - "   ‚Ä¢ Auditd monitoreando archivos cr√≠ticos"
          - "   ‚Ä¢ Logs de autenticaci√≥n activos"
          - "   ‚Ä¢ Eventos registrados"
          - ""
          - "üìù GENERAR EVIDENCIAS:"
          - "   ansible-playbook playbooks/generar_evidencias_seguridad.yml -i inventory/hosts.yml"
          - ""
          - "üìñ DOCUMENTACI√ìN:"
          - "   cat docs/EVIDENCIAS_SEGURIDAD.md"
          - "   cat COMANDOS_SEGURIDAD.md"
          - ""
          - "üéØ NIVEL ALCANZADO: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê"
          - "   'Seguridad robusta, hardening completo'"
          - "=========================================="
