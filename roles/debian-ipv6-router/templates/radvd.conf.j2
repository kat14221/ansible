# Configuración RADVD para Router Advertisement (RA)
# Red IPv6 Unificada: {{ radvd_prefix }}
# Gateway: {{ lan_ipv6_address }}/{{ lan_ipv6_prefix }}
# Interfaz: {{ lan_interface }}

interface {{ lan_interface }}
{
        # Habilitar anuncios RA
        AdvSendAdvert on;

        # Managed Flag: Clientes usan DHCPv6 para obtener IP
        # Other Config Flag: Clientes usan DHCPv6 para DNS/otros parámetros
        AdvManagedFlag on;
        AdvOtherConfigFlag on;

        # Intervalo de envío de RA
        MinRtrAdvInterval 30;
        MaxRtrAdvInterval 100;

        # MTU de la red
        AdvLinkMTU 1500;

        # Subred IPv6: {{ radvd_prefix }}
        prefix {{ radvd_prefix }}
        {
                # Prefijo on-link (en misma red)
                AdvOnLink on;
                
                # Autoconfiguración autónoma (SLAAC)
                AdvAutonomous on;
                
                # No incluir dirección del router en prefijo
                AdvRouterAddr off;
                
                # Tiempo de vida del prefijo (30 días)
                AdvValidLifetime 2592000;
                
                # Tiempo preferido (7 días)
                AdvPreferredLifetime 604800;
        };

        # DNS Recursivo (RDNSS) - Google Public DNS IPv6
        RDNSS {% for dns in dhcpv6_dns_servers %}{{ dns }}{% if not loop.last %} {% endif %}{% endfor %}
        {
                AdvRDNSSPreference 8;
                AdvRDNSSLifetime 3600;
        };

        # Ruta por defecto (Default Route)
        route ::/0 {
                AdvRoutePreference medium;
                AdvRouteLifetime 1800;
        };
};
