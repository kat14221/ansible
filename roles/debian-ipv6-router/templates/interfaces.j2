# Ansible managed file

source /etc/network/interfaces.d/*

# The loopback network interface
auto lo
iface lo inet loopback

# =================================================
# Interfaz WAN / Gestión ({{ wan_interface }})
# =================================================
auto {{ wan_interface }}
iface {{ wan_interface }} inet static
    address 172.17.25.122/24
    gateway 172.17.25.253
    # DNS se gestiona con systemd-resolved o /etc/resolv.conf

# =================================================
# Interfaz LAN ({{ lan_interface }})
# =================================================
auto {{ lan_interface }}
iface {{ lan_interface }} inet6 static
    address {{ lan_ipv6_address }}/{{ lan_ipv6_prefix }}
    # No hay gateway en la LAN, este es el gateway.

# --- Rutas estáticas persistentes ---
{% for route in static_routes | default([]) %}
    # Ruta a {{ route.network }} via {{ route.via }}
    up ip -6 route add {{ route.network }} via {{ route.via }} dev {{ route.dev | default(lan_interface) }} || true
    down ip -6 route del {{ route.network }} via {{ route.via }} dev {{ route.dev | default(lan_interface) }} || true
{% endfor %}